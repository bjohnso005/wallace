<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="wallace">
<title>Wallace Ecological Modeling Application v2.0 Vignette • wallace</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Wallace Ecological Modeling Application v2.0 Vignette">
<meta property="og:description" content="wallace">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">wallace</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.9.3</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/module-addition-vignette.html">How to write a module in Wallace</a>
    <a class="dropdown-item" href="../articles/wallace_vignette.html">Wallace Ecological Modeling Application v2.0 Vignette</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Wallace Ecological Modeling Application v2.0 Vignette</h1>
                        <h4 data-toc-skip class="author">Bethany A.
Johnson, Gonzalo E. Pinilla-Buitrago, Andrea Paz, Jamie M. Kass, Sarah
I. Meenan, Cory Merow, Robert P. Anderson</h4>
            
            <h4 data-toc-skip class="date">4/18/2022</h4>
      
      
      <div class="d-none name"><code>wallace_vignette.Rmd</code></div>
    </div>

    
    
<p><img src="vignette_img/logo.png" width="25%" style="display: block; margin: auto;"></p>
<div class="section level2">
<h2 id="preface">Preface<a class="anchor" aria-label="anchor" href="#preface"></a>
</h2>
<p>Welcome to the <em>Wallace EcoMod v2.0</em> vignette. This vignette
was written specifically for v2.0, so if you are using a different
version, some things may not match up. Click
<a href="https://wallaceecomod.github.io/vignettes/wallace_vignette.html" target="_blank" class="external-link">here</a>
for the v1.0 vignette.<br>
Additionally, we anticipate that this vignette and any others in the
<code>wallace</code> package will be updated regularly in accordance
with ongoing development.</p>
<div class="section level4">
<h4 id="outline">Outline<a class="anchor" aria-label="anchor" href="#outline"></a>
</h4>
<blockquote>
<p><a href="#Intro">Introduction</a><br><a href="#Setup">Setup</a><br><a href="#Orientation">Orientation</a><br><a href="#Occ">Obtain Occurrence Data</a><br><a href="#Env">Obtain Environmental Data</a><br><a href="#Proc">Process Occurrence Data</a><br><a href="#ProcEnv">Process Environmental Data</a><br><a href="#Espace">Characterize Environmental Space</a><br><a href="#Part">Partition Occurrence Data</a><br><a href="#Save">Save &amp; Load</a><br><a href="#Model">Build and Evaluate Niche Model</a><br><a href="#Vis">Visualize Model Results</a><br><a href="#Transfer">Model Transfer</a><br><a href="#Reprod">Reproduce</a><br><a href="#Con">Conclusion</a><br><a href="#Ack">Acknowledgements</a><br><a href="#Res">Resources</a><br><a href="#Ref">References</a><br></p>
</blockquote>
</div>
</div>
<div class="section level2">
<h2 id="introduction">
<a id="Intro"></a>Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p><em>Wallace</em> is an <code>R</code>-based GUI application for
ecological modeling that currently focuses on building, evaluating, and
visualizing models of species niches and distributions. We will refer to
these models as species distribution models (SDMs), and we will not
explain them at length here—as you read through, you will be pointed to
some sources of detailed information within the application (such as the
<strong>Component Guidance</strong> and <strong>Module Guidance</strong>
tabs) for reference.</p>
<p><em>Wallace</em> has many qualities which we think make it a good
example of next-generation scientific software: it’s 1) accessible, 2)
open, 3) expandable, 4) flexible, 5) interactive, 6) instructive, and 7)
reproducible.<br>
The application features a pannable/zoomable map and dynamic plots and
tables. Data for the models can be downloaded from online databases or
uploaded by the user. Most results can be downloaded, including the
option to save R code that can reproduce your analysis. For more
details, including on SDMs, please see our
<a href="http://onlinelibrary.wiley.com/doi/10.1111/2041-210X.12945/full" target="_blank" class="external-link">initial
publication</a> in <em>Methods in Ecology and Evolution</em><sup>1</sup>
and our
<a href="http://onlinelibrary.wiley.com/doi/10.1111/2041-210X.12945/full" target="_blank" class="external-link">followup
publication</a><sup>2</sup> in <em>Name of publisher of v2</em>.</p>
<ol style="list-style-type: decimal">
<li><p>Kass, J.M., Vilela, B., Aiello-Lammens, M.E., Muscarella, R.,
Merow, C., Anderson, R.P. (2018). <em>Wallace</em>: A flexible platform
for reproducible modeling of species niches and distributions built for
community expansion. <em>Methods in Ecology and Evolution</em>,
9(4),1151-1156. <a href="https://doi.org/10.1111/2041-210X.12945" class="external-link uri">https://doi.org/10.1111/2041-210X.12945</a></p></li>
<li><p>Kass JM, Pinilla-Buitrago GE, Paz A, Grisales-Betancur V, Johnson
BA, Meenan SI, Attali D, Broennimann O, Galante PJ, Maitner BS, Owens
HL, Varela S, Aiello-Lammens ME, Merow C, Blair ME, Anderson RP.
Interactive and reproducible modeling of species niches and
distributions with customizable workflows using the redesigned and
expanded Wallace 2.0. In Prep.</p></li>
</ol>
<p>The <em>Wallace</em> project’s
<a href="https://wallaceecomod.github.io/" target="_blank" class="external-link">main page</a>
has links to the
<a href="https://groups.google.com/forum/#!forum/wallaceecomod" target="_blank" class="external-link">Google
Group</a>, the official
<a href="mailto:wallaceecomod@gmail.com" target="_blank">email</a>, the
<a href="https://CRAN.R-project.org/package=wallace" target="_blank" class="external-link">CRAN
page</a> hosting the stable version, and the
<a href="https://github.com/wallaceEcoMod/wallace" target="_blank" class="external-link">Github
development page</a>. Wallace also has a
<a href="https://www.youtube.com/channel/UCDSLCE5bmw12B7oqmlKk7rg" target="_blank" class="external-link">YouTube
channel</a> with various tutorial videos and recorded seminars.</p>
</div>
<div class="section level2">
<h2 id="setup">
<a id="Setup"></a>Setup<a class="anchor" aria-label="anchor" href="#setup"></a>
</h2>
<div class="section level4">
<h4 id="installing-the-package">Installing the package<a class="anchor" aria-label="anchor" href="#installing-the-package"></a>
</h4>
<p>For <code>wallace</code> to work, you should be using R version 3.5.0
or later. Download for
<a href="https://cran.r-project.org/bin/windows/base/" target="_blank" class="external-link">Windows</a>
or
<a href="https://cran.r-project.org/bin/macosx/" target="_blank" class="external-link">Mac</a>.</p>
<p>To install and load <em>Wallace v2.0</em>, open either the base
<code>R</code> software or RStudio and run the code below. It’s the only
code you’ll have to run to use <code>wallace</code>.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Install Wallace from GitHub</span>
<span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"remotes"</span><span class="op">)</span>
<span class="fu">remotes</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"https://github.com/wallaceEcoMod/wallace/tree/multiSp"</span><span class="op">)</span>
<span class="co"># Load Wallace</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://wallaceEcoMod.github.io" class="external-link">wallace</a></span><span class="op">)</span>
<span class="co"># Run Wallace</span>
<span class="fu"><a href="../reference/run_wallace.html">run_wallace</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p>The <em>Wallace</em> GUI will open in your default web browser and
the <code>R</code> console will be occupied while <em>Wallace</em> is
running.</p>
<p>The <code>R</code> console displays messages regarding R-package
information or any error messages if complications arise, including
valuable information for troubleshooting.</p>
<p>If you’d like to use the <code>R</code> console while running
<em>Wallace</em>, open a terminal window (MacOS/Linux) or command prompt
(Windows), initialize <code>R</code>, and then run the lines above.</p>
<p><img src="vignette_img/setup_1.png" width="50%"></p>
<p>An example with Terminal in MacOS</p>
<p>To exit <em>Wallace</em>, hit ‘Escape’ while in the <code>R</code>
console and close the browser window, or clicking the power button in
the top right corner of the GUI will do both these steps. Note: If you
close the browser window running <em>Wallace</em>, <strong>your session
will be over and all progress will be lost</strong>.</p>
</div>
<div class="section level4">
<h4 id="setting-up-java-version-of-maxent">
<em>Setting up Java version of Maxent</em><a class="anchor" aria-label="anchor" href="#setting-up-java-version-of-maxent"></a>
</h4>
<p><em>Wallace v2.0</em> includes two options to run Maxent models:
maxnet and maxent.jar. The former, which is an <code>R</code>
implementation and fits the model with the package <code>glmnet</code>,
is now the default and does not require the package <code>rJava</code>
(see Phillips et al. 2017). The latter, which is the Java
implementation, runs the <code>maxent()</code> function in the package
<code>dismo</code>. This function requires the user to place the
maxent.jar file in the /java directory of the dismo package root folder.
You can download Maxent
<a href="https://biodiversityinformatics.amnh.org/open_source/maxent/" target="_blank" class="external-link">here</a>,
and locate maxent.jar, which is the Maxent program itself, in the
downloaded folder. You can find the directory path to dismo/java by
running system.file(‘java’, package=“dismo”) at the R console. Simply
copy maxent.jar and paste it into this folder. If you try to run Maxent
in Wallace without the file in place, you will get a warning message in
the log window and Maxent will not run. Also, if you have trouble
installing <code>rJava</code> and making it work, there is a bit of
troubleshooting on the <em>Wallace</em> Github repository
<a href="https://github.com/wallaceEcoMod/wallace/blob/master/README.md" target="_blank" class="external-link">README</a>
that hopefully should help.</p>
</div>
</div>
<div class="section level2">
<h2 id="orientation">
<a id="Orientation"></a>Orientation<a class="anchor" aria-label="anchor" href="#orientation"></a>
</h2>
<p><img src="vignette_img/orientation_1.png" width="800px" style="display: block; margin: auto;"></p>
<p>We’ll begin with an orientation of the <em>Wallace</em> interface.
After running the code above, <em>Wallace</em> opens to the
<strong>Intro</strong> page. The <em>Intro</em> tab contains background
information about the program. The <em>Team</em> tab has details about
the developers and collaborators who contributed to <em>Wallace</em>.
The <em>How to Use</em> tab contains brief user manual; it is an
abridged version of this vignette without a worked example. The <em>Load
Prior Session</em> tab is for just that- loading a prior session, which
we will get to <a href="#Save">later</a>.</p>
<p>Along the top in the orange panel are the
<strong>Components</strong>, which represent the steps of analysis. Each
of these component tabs open to the corresponding step. Within each
component are several <strong>Modules</strong>, which are discrete
analyses options within the components. To the left in the grey panel is
the <em>Wallace</em> WORKFLOW, outlining the version number, components
(numbered), and modules (bulleted) currently included.</p>
<p>Click on the component tab after Intro, <strong>Occ Data</strong>,
select a module, and consult the schematic below showing the different
parts of <em>Wallace</em>.</p>
<p><img src="vignette_img/orientation_2.png" width="800px" style="display: block; margin: auto;"></p>
<p>(<strong>1</strong>) These are the components. You will be stepping
sequentially through them. We have newly added a Support button
(<strong>1a</strong>), which links to the Google Group, email, website,
and the Github page to report issues. Here is the quit button
(<strong>1b</strong>), which will end the session.<br>
(<strong>2</strong>) This is the toolbar with all the user interface
controls, like buttons, text inputs, etc. You can see that the “module”
called <em>Query Database (Present)</em> is currently selected. You’ll
see that other two other modules exist for this component: <em>Query
Database (Paleo)</em> and <em>User-specified</em>. This module lets you
upload your own occurrence data. Try choosing this module instead and
notice that the toolbar changes, then click back to <em>Query Database
(Present)</em>.<br>
Both the Component and Module have ‘?’ buttons at the end. Clicking
these will link to the respective guidance texts. See “Component
Guidance” and “Model Guidance” below.<br>
Within this toolbar, you can find the module name and the <code>R</code>
packages it uses (<strong>2a</strong>) and the control panel for the
selected module (<strong>2b</strong>). Modules can be contributed by
other researchers and the developers, CRAN links, and documentation are
at the bottom.<br>
(<strong>3</strong>) The right side is the visualization space. Any
functions performed will be recorded in the log window
(<strong>3a</strong>). This window will also display any error messages.
Unlike previous versions, <em>Wallace v2.0</em> allows the user to load
multiple species. If you have done so, the species drop-down menu
(<strong>3b</strong>), lets you toggle between them.<br>
The visualization space includes several tabs (<strong>3c</strong>);
including an interactive map, occurrence records table, results window,
model and component guidance text windows, and a tab for saving outputs
and the current session.<br></p>
<p><em>Note to Chrome users: If you find the map is loading incorrectly
after downloading an object, specifically the corner tile loads but the
rest of the map is grey, close the download bar at the bottom of the
page should reset the map and fix the problem.</em></p>
<p>At this stage of the analysis, no results exist, and you have no data
yet for the table, but you can view the <strong>Component
Guidance</strong> and <strong>Module Guidance</strong> text now. This
text was written by the developers to prepare users for each component
and module <em>methodologically</em> (what the tools do) and
<em>theoretically</em> (why we should use them). The guidance text also
references scientific papers from the ecology literature for more
detailed reading. Please get into the habit of consulting these before
undertaking analyses, as they should give you a more solid foundation
for moving forward.<br>
The next tab in the visualization space, <strong>Save Session</strong>,
is very useful. At any point along the workflow, selecting “Save
session” within this tab will save the progress as a RDS (.rds) file.
This file can be loaded back into <code>wallace</code> to resume
analysis. If at any point during the vignette you need to pause, jump to
<a href="#Save">Save &amp; Load</a> to learn how to save/load your
Wallace session.</p>
<p>Let’s begin our analysis.<br></p>
<p>We’ll be modeling two species of olingo:</p>
<p><em>Bassaricyon neblina</em>, the olinguito. Olinguitos are montane
mammals of the raccoon family Procyonidae who gained species status in
2013. This is a species of concern listed as “near threatened” by the
IUCN, and has a range in the Andes mountains of western Colombia and
Ecuador (Helgen et al. 2020)</p>
<p><em>Bassaricyon alleni</em>, the eastern lowland olingo. These
olingos are listed as Least Concern and have a range throughout northern
South America (Helgen et al. 2016).</p>
</div>
<div class="section level2">
<h2 id="obtain-occurrence-data">
<a id="Occ"></a>Obtain Occurrence Data<a class="anchor" aria-label="anchor" href="#obtain-occurrence-data"></a>
</h2>
<p>Make sure you are in the first component, <strong>Obtain Occurrence
Data</strong>, and click to read the component guidance text. There are
three modules available for obtaining occurrence data: <em>Query
Database (Present)</em>, <em>Query Database(Paleo)</em>, and
<em>User-Specified</em>. Choose a module and click on the module
guidance text. Notice the module guidance texts change as you select
between the three modules. Let’s read through these to get a better
understanding of what is involved in obtaining occurrence data, and how
<em>Wallace</em> implements it.</p>
<p><img src="vignette_img/occs_1.png" width="800px" style="display: block; margin: auto;"></p>
<p><img src="vignette_img/occs_2.png" width="800px" style="display: block; margin: auto;"></p>
<p>Let’s proceed to getting occurrences. We’ll be using present data and
as such use the <em>Query Database (Present)</em> module. There are a
selection of databases to choose from and the option to only return
occurrences that contain information on coordinate uncertainty. If you
have a GBIF User ID, checking the “Include Data Source” box will allow
you to log in with your username and password and send the data source
citations to your email.</p>
<p>Choose GBIF, keep uncertainty unchecked, type in
<code>Bassaricyon neblina</code> into the scientific name box, set the
maximum number of occurrences to 200, and click <strong>Query
Database</strong>.</p>
<p>After the download is complete, the log window will contain
information on the analysis performed. Your search returned 58**
records, but after accounting for records without coordinate information
(latitude, longitude) and removing duplicate records, 43** remain. This
species has few records, so setting the maximum to 200 is sufficient,
but for modeling with data-rich species, 200 may not be enough for
capturing the whole range, and the maximum can be increased.</p>
<p>**<em>Numbers may be different.</em>
<img src="vignette_img/occs_3.png" width="800px" style="display: block; margin: auto;"></p>
<p>Now click on the “Occurrences” tab to view more information on the
records. The developers chose the fields that are displayed based on
their general relevance to studies on species ranges.</p>
<p><img src="vignette_img/occs_4.png" width="800px" style="display: block; margin: auto;"></p>
<p>Click the <strong>Save</strong> tab. The first save box allows you to
download your session. It is available here in all the components and
modules (See Save &amp; Load section for more details). The download
options below the save box change depending on which module is selected
and the analysis run. Here, you can get a .csv file of the records just
acquired. The first option will download the original database fields
for every downloaded record (before any filtering). The second option
downloads the current table. The third option, Download all data, is
unavailable at this point but that will change after we include our
second species.</p>
<p><img src="vignette_img/occs_5.png" width="800px" style="display: block; margin: auto;"></p>
<p>A major improvement in <em>Wallace</em> v2.0 from previous versions
is the ability to model multiple species in the same session. Let’s add
another species to model.</p>
<p>Aside from GBIF, you can query the Vertnet (vertebrate data), BISON
(biodiversity data within the U.S. and Canada), and newly added BIEN
(botantical) databases for species occurrence records. In the second
module <em>Query Database (Paleo)</em> you can query PaleoDB databases
for fossil records by selecting a time interval and species.<br>
If you have our own data, you can import it using the third module,
<em>User-specified</em>. Your occ data file must be a .csv with the
columns “scientific_name”, “longitude”, and “latitude”, explicitly named
and in that order. It may have other columns, but those must be the
first three. You also now have the option to specify the delimiter and
separator of your file.</p>
<p>We’ll continue with GBIF present data. Search the database for
<em>Bassaricyon alleni</em> (eastern lowland olingo), keeping the max
set at 200. This returns 81 records and cleans it to 42 records. You
might have noticed the log window updated, but the map is the same. The
map will not change automatically and because <em>Bassaricyon
neblina</em> is still selected in the Species log, it is still showing
that data. Toggle between species to show the map of <em>Bassarricyon
alleni</em>.</p>
<p><img src="vignette_img/occs_6.png" width="800px" style="display: block; margin: auto;"></p>
<p>Click back to the <strong>Save</strong> tab. Notice the third option
which was unavailable before is now available.</p>
</div>
<div class="section level2">
<h2 id="obtain-environmental-data">
<a id="Env"></a>Obtain Environmental Data<a class="anchor" aria-label="anchor" href="#obtain-environmental-data"></a>
</h2>
<p>Next, you will need to obtain environmental variables for the
analysis. The values of the variables are extracted for the occurrence
records, and this information is provided to the model. These data are
in raster form, which simply means a large grid where each grid cell
specifies a value. Rasters can be displayed as surfaces on maps (we’ll
see this later). Click on the component <strong>Env Data</strong>. The
first module, <em>WorldClim Bioclims</em>, lets you download bioclimatic
variables from
<a href="https://www.worldclim.org/" target="_blank" class="external-link">WorldClim</a>, a
global climate database of interpolated climate surfaces derived from
weather station data at multiple resolutions. The coverage is better for
areas with more weather stations (especially in developed countries),
and more uncertainty exists in areas with fewer stations. The
<a href="https://www.worldclim.org/data/bioclim.html" target="_blank" class="external-link">bioclim</a>
variables are summaries of temperature and precipitation that have been
proposed to have general biological significance. You have the option to
specify a subset of the 19 total variables to use in the analysis.</p>
<p>The second module, <em>ecoClimate</em>, is a newly added module that
includes Paleo reconstructions. It accesses climatic layers from the
PMIP3 – CMIP5 projects from
<a href="https://www.ecoclimate.org/" target="_blank" class="external-link">ecoClimate</a>.
Users can select from Atmospheric Oceanic General Circulation Models and
choose a temporal scenario to use. All ecoClimate layers have a
resolution of 0.5 degrees, whereas WorldClim allows resolution options
of 30arcsec, 2.5 arcmin, 5 arcmin, or 10 arcmin.</p>
<p>The third module, <em>User-specified</em>, is for uploading your own
rasters into Wallace. They can be continuous, numerical, or categorical
variables to provide to the model.</p>
<p>We’ll be using WorldClim. The first time you use Wallace these data
are downloaded to a temporary folder in your hard drive; after that they
will simply be loaded from this local directory. You have the option to
save to memory for faster processing- this internally saves the data
temporarily as a rasterbrick in your RAM for Wallace to access. Finer
resolutions will take longer to download. The finest resolution data
(<strong>30 arcsec</strong>) is served by tile, and thus a single tile
that corresponds to the map center will be downloaded. Set the
resolution to 30 arcsec and the latitudinal and longitudinal points of
the map center will be given. To visualize how well the tile will
encompass the points, click the <strong>30 arcsec tile</strong> box in
the bottom left corner of the map. The points outside the tile will be
excluded; you may need to zoom out to see fully.</p>
<p><img src="vignette_img/env_1.png" width="800px" style="display: block; margin: auto;"></p>
<p>Choose the 2.5 arcmin bioclimatic variable resolution and keep all 19
bioclimatic variables checked. Note that the selections made will be
performed for only the species selected in the Species log box, unless
the Batch box is checked.</p>
<p>The Batch button will perform the analysis you’ve set up in the
module for all the species you have uploaded. You’ll notice this option
in many of the components. If you want to perform individualized
analyses for each species, (in this case, different environmental
variables), leave it unchecked. Note: The batch option is not available
for 30arcsec resolution since different tiles may need to be
accessed.<br>
Check Batch and Load Env Data. Notice the progress bar in the
bottom-right corner.</p>
<p><img src="vignette_img/env_2.png" width="800px" style="display: block; margin: auto;"></p>
<p>After the rasters have loaded, the “Results” tab will display summary
information about them (e.g. resolution, extent, cell number, etc.). In
addition to downloading the rasters, Wallace will also remove any
occurrence points with no environmental values (i.e., points that did
not overlap with the rasters).</p>
<p><img src="vignette_img/env_3.png" width="800px" style="display: block; margin: auto;"></p>
<p>You can download your environmental variables from within the
Download Data section of the Save tab.</p>
</div>
<div class="section level2">
<h2 id="process-occurrence-data">
<a id="Proc"></a>Process Occurrence Data<a class="anchor" aria-label="anchor" href="#process-occurrence-data"></a>
</h2>
<p>The next component, <strong>Process Occs</strong>, gives you access
to some data-cleaning tools. The data you retrieved from GBIF is raw,
and there will almost always be some erroneous points. Some basic
knowledge of the species’ range can help us remove the most obvious
errors. For databases like GBIF that accumulate lots of data from
various sources, there are inevitably some dubious localities that may
be represented; for example, a museum location instead of the
coordinates associated with the specimen, or an inverse of the latitude
and longitude. In order to eliminate these obviously erroneous records,
select only the points you want to keep for analysis with the module
<em>Select Occurrences On Map</em>. Alternatively, you can also remove
specific occurrences by ID with the module <em>Remove Occurrences by
ID</em>. Even after removing problematic points, the points you have
left may be clustered due to sampling bias. This often leads to
artifactually inflated spatial autocorrelation, which can bias the
environmental signal for the occurrence data that the model will attempt
to fit. For example, there might be clustering of points near cities
because the data are mostly from citizen scientists who live in or near
those cities. Or the points can cluster around roads because the field
biologists who took the data were either making observations while
driving or gained access to sites from these roads. The last module,
<em>Spatial thin</em> will help reduce the effects of sampling bias.
Unlike other components, in <strong>Process Occs</strong> the modules
are not exclusive, and all can be used in any order.<br></p>
<p>Make sure <em>Bassaricryon alleni</em> is in the species log.<br>
We will practice using the first two modules with this species. In the
first module, we will use the polygon-drawing tool to select occurrences
on the map. The polygon drawing tool is useful to draw extents and will
be seen in other modules later on as well.</p>
<p>Click on the polygon icon on the map toolbar.</p>
<p><img src="vignette_img/poccs_1.png" width="50%" style="display: block; margin: auto;"></p>
<p>This opens the drawing tool. Click to begin drawing- each click
connects to the last with a line. Draw a shape around South America,
omitting the record in Bolivia. If you make a mistake drawing, you can
click “Delete last point” or Cancel to start over. To finish drawing,
click on the first point you made, or click ‘Finish’ in the drawing
tool. This finalizes the shape to use in analysis. Now click ‘Select
Occurrences’ and you will see the point in Bolivia disappear. To remove
the blue shaded polygon, click on the Trashcan icon in the map and hit
‘Clear All’. If you are displeased or have made an error, the red Reset
button will revert back to the original points. Since we arbitrarily
removed the record in Bolivia, click reset to return to our original
dataset.</p>
<p><img src="vignette_img/poccs_2.png" width="800px" style="display: block; margin: auto;"></p>
<p>We will now remove it again, this time using the second module,
<em>Remove Occurrences by ID</em>. With the pointer, click on the record
in Bolivia. Information on the record will pop up, starting with the
OccID. In this case it is OccID #18 (it may be a different number for
you). Other information from the attribute table will be available. For
example, the record has no information (NA) on the institution code,
state/province, or basis. Since we know the OccID number, we can find
the full information associated in the Occurrences tab. Click there and
find the record. Here we can see it is a preserved specimen from the
Museum of Southwestern Biology (MSB). Go back to the map. Enter “18” for
the ID to be removed and remove occurrence. You will see the point
disappear again. Click reset.</p>
<p><img src="vignette_img/poccs_3.png" width="800px" style="display: block; margin: auto;"></p>
<p>Click on the module <strong>Spatial Thin</strong>. This lets you
attempt to reduce a presumed spatial bias by running a spatial thinning
function on the points to make sure they’re all a defined distance from
one another. We will use “10 km” as an example and thin for both species
by using the <em>Batch</em> option again.</p>
<p><img src="vignette_img/poccs_4.png" width="800px" style="display: block; margin: auto;"></p>
<p>We are now left with 35 points for <em>Bassaricyon alleni</em> and 21
for <em>Bassaricyon neblina</em> (your numbers may be different). You
can zoom in to see what the function did. Red points were retained, and
blue points were removed. Download the processed occurrence datasets as
a .csv by clicking on the button within the <strong>Download</strong>
tab. Reminder: the data downloaded is only for the species currently in
the species drop-down menu.</p>
</div>
<div class="section level2">
<h2 id="process-environmental-data">
<a id="ProcEnv"></a>Process Environmental Data<a class="anchor" aria-label="anchor" href="#process-environmental-data"></a>
</h2>
<p>Now we will need to choose the study extent for modeling. This will
define the region from which “background” points are drawn for model
fitting. Background points are meant to sample the total area available
to the study species. Methods like Maxent are known as
presence-background techniques because they compare the predictor
variable values at background points to those at the occurrence points
(as opposed to presence-absence techniques, which require absence data).
In making decisions about the study extent, we want to avoid areas the
species has historically been unable to move to—for example, regions
beyond a barrier like a mountain range or large river that the species
cannot traverse. Including these areas may send a false signal to the
model that these areas are not environmentally suitable. Please see the
guidance text for more details.</p>
<p>You can explore the different options for delineating the study
extent here. Each module has two steps here: 1) choosing the shape of
the background extent, and 2) sampling the background points. To begin,
go to the module <em>Select Study Region</em>. Under “Step 1”, try out
the different options and see how each one draws the background shape.
Try increasing and decreasing the buffer to see how the shape is
affected. Set the species to <em>B. neblina</em> and use <em>Select
study region</em> to a minimum convex polygon with a 0.7° buffer
distance. Then switch to <em>B. alleni</em> and use point buffers with a
0.7° buffer.</p>
<p><img src="vignette_img/penvs_1.png" width="800px" style="display: block; margin: auto;"><img src="vignette_img/penvs_2.png" width="800px" style="display: block; margin: auto;"></p>
<p>Alternatively, you can draw your own polygon (using the same polygon
drawing tool we tested in the previous component <strong>Process
occs</strong>. If you have a file of the background extent, you can
upload it into the <em>User-specified Study Region</em> module. This can
accept a shapefile (must include each of the three .shp, .shx, and .dbf
files) or a .csv file with the field order (longitude, latitude). Note
that the polygon you draw or shape you upload needs to contain all the
occurrence points.</p>
<p>Next, complete “Step 2”, which both clips the rasters by the study
extent and samples the background points. Set the number of background
points to 10,000 (bigger, more extensive, samples are better; See
component guidance text), check <strong>Batch</strong>, and click the
<strong>Sample</strong> button.</p>
<p><img src="vignette_img/penvs_3.png" width="800px" style="display: block; margin: auto;"></p>
<p>You may find requesting 10,000 background points exceeds the amount
in the background extent. The available number of points will be given
in the log window, and that amount can be used instead of 10,000.</p>
<p>Click the <strong>Download</strong> button if you want a zip file of
the clipped rasters (e.g., the environmental data clipped to the extent
of the background you just created). Make sure to toggle the species to
download the file for each one.</p>
</div>
<div class="section level2">
<h2 id="environmental-space">
<a id="Espace"></a>Environmental Space<a class="anchor" aria-label="anchor" href="#environmental-space"></a>
</h2>
<p>Before we begin the <strong>Environmental Ordination</strong>
analysis, you need to select two species to work with. If you had more
than two species uploaded, select two from the species log drop-down.
Since we only have two uploaded, click in the species log box and select
the second species. Both names will appear in the species log box
simultaneously.</p>
<p><img src="vignette_img/espace_1.png" width="800px" style="display: block; margin: auto;"></p>
<p>Unlike the other components which let you perform the modules in any
order, the modules within <strong>Environmental Space</strong> are
progressive and need to be performed consecutively (i.e., you can’t get
an Occurrence Density Grid without first performing an Environmental
ordination).</p>
<p>The first module <em>Environmental Ordination</em> is for calculating
Principal Component Analysis (PCA). To perform PCA, select the variables
available for both species by checking/unchecking the bioclimatic
variables. Choose between “Occurrences Only” or “Occurrences &amp;
Background” for the plot selection and set the x- and y-axis components.
The PCA Scatterplot appears in the Results tab.</p>
<p><img src="vignette_img/espace_2.png" width="800px" style="display: block; margin: auto;"></p>
<p>You can also view the PCA correlation circle, PCA screenplot, and the
PCA results summary. For more information on these statistics, consult
the module guidance text.</p>
<p><img src="vignette_img/espace_3.png" width="800px" style="display: block; margin: auto;"></p>
<p><img src="vignette_img/espace_4.png" width="800px" style="display: block; margin: auto;"></p>
<p><img src="vignette_img/espace_5.png" width="800px" style="display: block; margin: auto;"></p>
<p>Next, run an Occurrence Density Grid…</p>
<p><img src="vignette_img/espace_6.png" width="800px" style="display: block; margin: auto;"></p>
<p>And calculate Niche overlap…</p>
<p><img src="vignette_img/espace_7.png" width="800px" style="display: block; margin: auto;"></p>
<p>Since we have yet to model, this overlap is calculated from the
occurrence densities and the densities of the environmental conditions
from the density grid results of the previous module. The overlap is
quantified using Schoener’s D metric.</p>
<p>Download the results of these analyses (PCA results, density grid,
and overlap plot) from the <strong>Download</strong> tab.</p>
</div>
<div class="section level2">
<h2 id="partition-occurrences">
<a id="Part"></a>Partition Occurrences<a class="anchor" aria-label="anchor" href="#partition-occurrences"></a>
</h2>
<p>We have not built any models yet, but before we do, we will make
decisions on how to partition our data for evaluation. In order to
determine the strength of the model’s predictive ability, you
theoretically need independent data to validate it. When no independent
datasets exist, one solution is to partition your data into subsets that
we assume are independent of each other, then sequentially build a model
on all the subsets but one and evaluate this model on the left-out
subset. This is known as k-fold cross-validation (where k is the total
number of subsets), and it is quite prevalent in statistics, especially
the fields of machine learning and data science. After this sequential
model-building exercise is complete, <em>Wallace</em> summarizes
(averages) the statistics over all the partitions and then builds a
model using <strong>all</strong> the data.<br>
There’s a whole literature on how to best partition data for modeling.
One option is to simply partition randomly, but with spatial data we run
the risk that the groups are not spatially independent of each other.
The jackknife method is recommended for species with small sample sizes
and has previously been used for modeling <em>Bassaricyon neblina</em>
<a href="https://doi.org/10.1093/jmammal/gyy012" target="_blank" class="external-link">(Gerstner
et al. 2018)</a> but may have long computational times
<a href="https://jamiemkass.github.io/ENMeval/articles/ENMeval-2.0.0-vignette.html#jack" target="_blank" class="external-link">(Kass
et al. 2021)</a>.</p>
<p>Another option is to partition using spatial blocking—for example, by
drawing lines on a map to divide the data. Spatial partitioning with
k-fold cross-validation forces the model to predict to regions that are
distant from those used to train the model. For <em>Bassaricyon
alleni</em>, environmental conditions in the Andes of Colombia and
Ecuador may differ considerably from conditions in Bolivia. If the model
has accurate predictions on average on withheld spatially partitioned
data, it likely has good transferability, which means it can transfer
well to new values of predictor variables (as distant areas are usually
more environmentally different than close areas). Please refer to the
guidance text for more details on all the types of partitioning offered
in Wallace. <br> Here’s an example of jacknife (k=n), which assigns each
point to a its own partition group, so the number of bins equals the
number of occurrences.</p>
<p><img src="vignette_img/part_1.png" width="800px" style="display: block; margin: auto;"></p>
<p>Here’s an example of spatial blocking, which assigns each point to
one of four spatially separate partition groups.</p>
<p><img src="vignette_img/part_2.png" width="800px" style="display: block; margin: auto;"></p>
<p>We’ll use this method now for faster computation, but it is
recommended to review the guidance text and other literature to make an
informed decision on partition methods.</p>
<p>Partition both species with Spatial Partition module method Block
(k=4).</p>
</div>
<div class="section level2">
<h2 id="save-load-session">
<a id="Save"></a>Save &amp; Load Session<a class="anchor" aria-label="anchor" href="#save-load-session"></a>
</h2>
<p>Before we go into Modeling, let’s explore one of the great new
features of Wallace v2.0, which is the ability to stop and save your
progress to be continued later. If you want to skip this step, you can
move on to <a href="#Model"><strong>Model</strong></a>.</p>
<p>Click “Save Session” within the <strong>Save</strong> tab. This tab
is available from any of the Components. This will save your progress as
an RDS (.rds) file. After it saved, you can hit the stop sign in the
upper right corner or close the browser window and exit R/RStudio.
<em>Note: if the Wallace session is closed before saving, all work will
be lost</em>.</p>
<p>When you are ready to resume, load Wallace again.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://wallaceEcoMod.github.io" class="external-link">wallace</a></span><span class="op">)</span>
<span class="fu"><a href="../reference/run_wallace.html">run_wallace</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p>In the <strong>Intro</strong> component, use the
<strong>Load</strong> tab to import your .rds session file.</p>
<p><img src="vignette_img/save_1.png" width="800px" style="display: block; margin: auto;"></p>
<p>A box will pop up– It looks like other <em>Wallace</em> warning
messages, but in this case it is indicating the session is loaded. You
can now carry on with the previous analysis.</p>
<p><img src="vignette_img/save_2.png" width="800px" style="display: block; margin: auto;"></p>
</div>
<div class="section level2">
<h2 id="model">
<a id="Model"></a>Model<a class="anchor" aria-label="anchor" href="#model"></a>
</h2>
<p>We are now ready to build a model. <em>Wallace v2.0</em> provides two
algorithm options; Maxent and BIOCLIM. For this vignette, we’ll use
Maxent, a machine learning method that can fit a range of functions to
patterns in the data, from simple (i.e. straight lines) to complex
(i.e. curvy). For more details on Maxent, please consult the
<a href="https://biodiversityinformatics.amnh.org/open_source/maxent/" target="_blank" class="external-link">Maxent
website</a> or guidance text.<br>
Maxent is available to run through <code>maxnet</code> package or
through Java with the <code>maxent.jar</code> option. In the interest of
time, let’s choose the following modeling options:</p>
<ul>
<li><p>Choose maxnet</p></li>
<li>
<p>Select L, LQ, and H feature classes. These are the shapes that
can be fit to the data:</p>
<ul>
<li>L = Linear, e.g. temp + precip<br>
</li>
<li>Q = Quadratic, e.g. temp^2 + precip^2<br>
</li>
<li>H = Hinge, e.g. piecewise linear functions, like splines<br>
</li>
</ul>
</li>
<li>
<p>Select regularization multipliers between 0.5-4 with a step value
of 0.5.</p>
<ul>
<li>Regularization is a way to reduce model complexity.<br>
</li>
<li>Higher values = smoother, less complex models. Basically, all
predictor variable coefficients are shrunk progressively until some
reach 0, when they drop out of the model. Only those variables with the
greatest predictive contribution remain in the model.<br>
</li>
</ul>
</li>
<li>
<p>Keep “NO” selected for categorical variables. This option is to
indicate if any of your predictor variables are categorical.</p>
<ul>
<li>Had you loaded categorical variables, you would check here and then
indicate which of the rasters is categorical.<br>
</li>
</ul>
</li>
<li><p>Set Clamping? to “TRUE”. This will clamp the model
predictions.<br></p></li>
<li><p>If you set Parallel? to “TRUE”, you can indicate the number of
cores (e.g., max = 4) for parallel processing, if your machine can
handle it. Otherwise, set it to “FALSE”.</p></li>
</ul>
<p>We will model for <em>Bassaricyon neblina</em>, but note the Batch
feature can be checked to run these selections for any/all species
you’ve uploaded.<br>
Make sure <em>Bassaricyon neblina</em> is in the species box and Batch
is unchecked before hitting <strong>Run</strong>.<br>
The 3 feature class combinations (L, LQ, H) * 8 regularization
multipliers (0.5, 1, 1.5, 2, 2.5, 3, 3.5, 4) = 24 candidate models. The
feature classes H will enable substantial complexity in the response, so
it takes a bit longer to run than the simpler models.</p>
<p><img src="vignette_img/model_1.png" width="800px" style="display: block; margin: auto;"></p>
<p>The results appear in two tables of evaluation statistics, allowing
comparison of the different models you just built. The first table is
full model and partition averages statistics; There should be 24 rows:
one for each of the feature class / regularization multiplier
combinations you selected. In the first table, statistics from the
models built from the 4 occurrence data partition groups are averaged.
In the second table, statistics from each of the 4 groups are displayed
separately, so it contains 96 rows (each of the 4 folds for each of the
24 models).</p>
<p><img src="vignette_img/model_2.png" width="800px" style="display: block; margin: auto;"></p>
<p>How do we choose the “best” model?<br>
There is a mountain of literature about this, and there is really no
single answer. AUC (Area Under the Curve), OR (Omission Rate), and CBI
(continuous Boyce Index) were calculated using our partitions, and AICc
(corrected Akaike information criterion) was instead calculated using
the model prediction of the full calibration background extent (and all
of the thinned occurrence points). Although AICc does not incorporate
the cross-validation results, it does explicitly penalize model
complexity—models with more parameters tend to have a worse AICc score.
It’s really up to the user to decide, and the guidance text has some
references which should help you learn more.</p>
<p>The evaluation metrics table can be sorted. First, we will prioritize
models that did not omit many of the occurrence points in the predicted
area. Sort the results table in ascending order by “or.10p.avg”, or the
10-percentile training presence threshold applied to testing data (see
guidance text for details).</p>
<p><img src="vignette_img/model_3.png" width="800px" style="display: block; margin: auto;"></p>
<p>Let’s also look at AUC values.</p>
<p><img src="vignette_img/model_4.png" width="800px" style="display: block; margin: auto;"></p>
<p>And AICc…
<img src="vignette_img/model_5.png" width="800px" style="display: block; margin: auto;"></p>
<p>In our example, if we had chosen the model with the lowest AICc
score, we would have ended up with LQ_2. Note: your values may be
different.</p>
<p>Next to the <strong>Evaluation</strong> results, you can access the
Maxent <strong>Lambda</strong> files for each of the models (changing
the candidate model in the drop-down box changes the output).</p>
<p><img src="vignette_img/model_6.png" width="800px" style="display: block; margin: auto;"></p>
<p>Use the <strong>Download</strong> tab to download the evaluation
tables.</p>
</div>
<div class="section level2">
<h2 id="visualize">
<a id="Vis"></a>Visualize<a class="anchor" aria-label="anchor" href="#visualize"></a>
</h2>
<p>There are four modules for Visualization. We’ll save the first,
<em>Map Prediction</em>, for last. We’ll skip the fourth module,
<em>BIOCLIM Envelope Plot</em>, since we used Maxent instead of
BIOCLIM.<br>
The module <em>Maxent Evaluation Plots</em>, enables users to evaluate
the performance statistics across models. Graphs appear in the Results
tab. Below, see how feature class and regularization multiplier affects
AUC values.</p>
<p><img src="vignette_img/vis_1.png" width="800px" style="display: block; margin: auto;"></p>
<p>We should also examine the <strong>response curves</strong>, which
show how the predicted suitability (y-axis) changes based on different
values of each variable (x-axis). If you want to see the results for a
particular model, select it by using the dropdown menu below the species
box. Below is one of the response curves for model LQ_2 on mean
precipitation of the driest month (bio14).</p>
<p><img src="vignette_img/vis_2.png" width="800px" style="display: block; margin: auto;"></p>
<p>You can also visualize model predictions on the map. Predictions of
suitability can be continuous (a range of values from low – high
suitability) or binary (thresholded to just two values: 0-unsuitable and
1-suitable). Please see the module guidance for information about Maxent
model output scales and thresholding rules. Here is the mapped
prediction for model LQ_2, no threshold, in cloglog output.</p>
<p><img src="vignette_img/vis_3.png" width="800px" style="display: block; margin: auto;"></p>
<p>Below is the mapped prediction of the same model, this time with the
threshold set to 10-percentile training presence. Some of the occurrence
points may fall outside the blue areas that represent suitable areas for
<em>Bassaricyon neblina</em>. This thresholded prediction was used to
calculate the 10-percentile training presence omission rate from the
evaluation statistics.</p>
<p><img src="vignette_img/vis_4.png" width="800px" style="display: block; margin: auto;"></p>
<p>Try mapping the prediction with the threshold set to the less strict
‘minimum training presence’ and notice the difference. You can also
threshold by a quantile of training presences. Try setting the quantile
to different values and notice the change in prediction.</p>
<p><img src="vignette_img/vis_5.png" width="800px" style="display: block; margin: auto;"></p>
<p>You may have noticed the batch option is not available for this
component. Users need to select optimum models relative to each species,
therefor predictions can only be run individually.<br>
You can download your Maxent or BIOCLIM plots, response curves, and map
predictions from the <strong>Download</strong> tab. Note that this will
download the current plot. For instance, if you wanted to download the
continuous prediction, you’ll have to plot again, since we last plotted
the threshold map.</p>
</div>
<div class="section level2">
<h2 id="model-transfer">
<a id="Transfer"></a>Model Transfer<a class="anchor" aria-label="anchor" href="#model-transfer"></a>
</h2>
<p>Next, you can transfer the model to new locations and past/future
climate scenarios. “Transferring” simply means plugging in new
environmental values to the model (i.e., those not used for model
building) and getting a new response (i.e., suitability predictions for
new variable ranges). <strong>Note: This can also be referred to as
“projecting” a model, but do not confuse this type of projecting with
the GIS term for changing the coordinate reference system of a
map.</strong></p>
<p>This is potentially confusing – didn’t the cross-validation step do
this too? The cross-validation with spatial partitioning sequentially
forced models to predict to new areas, and the evaluation statistics
summarized their ability to transfer accurately. However, the final
model that we used to make the predictions we are currently looking at
was built with <em>all</em> the data (it did not exclude any partition
groups). So the variable ranges associated with all of the background
points in our dataset were used in the model-building process.<br>
We are now taking this model and projecting it to variable ranges that
were potentially never used in model-building. Thus, these values for
different places and times might be completely new to our model and
could be so different that we may be uncertain in the accuracy of our
projection. Please see the guidance text for details on these
“non-analog conditions”.<br></p>
<p>Let’s begin with <em>Project to New Extent</em> and see if Peru has
suitable area for the olinguito. In Step 1, use the polygon drawing tool
to draw around Peru with a 1-degree buffer and hit Create.
Alternatively, you can upload a shapefile or CSV file with fields
“longitude, latitude” to use as a study region. (**)
<img src="vignette_img/Proj_1.png" width="800px" style="display: block; margin: auto;"></p>
<p>In Step 2, choose a threshold or no threshold and Project. (**)
<img src="vignette_img/Proj_2.png" width="800px" style="display: block; margin: auto;"></p>
<p>Note: to remove the outline of the polygon from the prediction, click
the Trashcan icon and “Clear all”.<br>
Now let’s try <em>Project to New Time</em>. There are three options to
choose a study region, but we will use the same extent in which our
model was built. Don’t forget to hit Create after making your selection
in Step 1. In Step 2, you have the choice of WorldClim or ecoclimate for
source variables.<br>
Below, model H_4 has been projected to the year 2070 under a severe
climate scenario: representative concentration pathway (RCP) 8.5. Notice
also that there are several global circulation models (GCMs) to choose
from—these all represent different efforts to model future climate. We
used CCSM4 for this tutorial. Not all GCMs have raster data for each
RCP. See the module guidance text for more on RCPs and GCMs. Note: some
databases have phased out RCPs for Shared Socioeconomic Pathways (SSPs),
so be advised some literature might use SSP terminology instead of RCP.
(**)
<img src="vignette_img/Proj_3.png" width="800px" style="display: block; margin: auto;"></p>
<p>Below is the projection made binary by the 10-percentile training
presence threshold. We can see some of these differences between present
and future projection a bit more clearly now. (**)
<img src="vignette_img/Proj_4.png" width="800px" style="display: block; margin: auto;"></p>
<p>The third module, <em>Project to User environments</em>, gives users
the option to project to their own uploaded environments. The first step
is the same as before (select the study region) but in the second step
they can upload single-format rasters (.tif, .asc) to use as the
environment. Note: the rasters must have the same extent and resolution
(cell size) and the names of the files must correspond to the
environmental variables used in modeling. To assist, there is a message
“Your files must be named as: …” indicating the correct file names to
use.</p>
<p>When projecting, there may be areas within our new ranges of values
that have high uncertainty because they are very different from the
values used in model-building. In order to visualize where these areas
are, we can use the fourth module <em>Calculate Environmental
Similarity</em>, to plot a MESS map. MESS stands for (M)ultivariate
(E)nvironmental (S)imilarity (S)urface: please see the module guidance
text for details. Below is the MESS for our projection. All the blue
values correspond to areas similar to those used in model-building,
while the red ones are much more different. We can see that future
climate values at high elevation are similar, whereas those at lower
elevations west towards the coast are very different in some places. We
may therefore interpret that projected suitability in these areas has
high uncertainty. (**)
<img src="vignette_img/Proj_5.png" width="800px" style="display: block; margin: auto;"></p>
</div>
<div class="section level2">
<h2 id="reproduce">
<a id="Reprod"></a>Reproduce<a class="anchor" aria-label="anchor" href="#reproduce"></a>
</h2>
<p>A major advantage of <em>Wallace</em> compared to other GUI-based
software is reproducibility. The first option within this component is
extracting all the session code used to run the analysis. While we were
using <em>Wallace</em>, lots of <code>R</code> code has been running in
the background. This option allows you to download a simplified version
of all that code in the form of a condensed and annotated <code>R</code>
script. You can use this script to rerun the analysis session, share it,
or modify it. The script can be downloaded in several ways, but the
<strong>R Markdown</strong> format, which is a convenient format for
combining R code and text, can be run directly in R. For .pdf downloads,
some version of TeX is necessary to be installed on your system. Please
see the text on this page for more details.<br>
To download the script, select Rmd and click Download.</p>
<p><img src="vignette_img/reprod_1a.png" width="800px" style="display: block; margin: auto;"></p>
<p>Now, you should have an .Rmd file that contains your complete
analysis. R Markdown* files combine regular text with <strong>code
chunks</strong>. Modules from <em>Wallace</em> are indicated as headers
denoted by <strong>###</strong>. For a quick reference to Rmd syntax,
see
<a href="https://rstudio.com/wp-content/uploads/2015/02/rmarkdown-cheatsheet.pdf" target="_blank" class="external-link">here</a>.</p>
<p>(**)
<img src="vignette_img/reprod_1b.png" width="50%" style="display: block; margin: auto;"></p>
<p>You might want to open a new R window and try running some of this
code. Remember that later sections of code may depend on things that
were done earlier, so they may not all run if you skip ahead. Note that
any <strong>Env Space</strong> analysis will appear at the end of the
file. Also remember that if you close your Wallace session you’ll lose
your progress in the web browser (but your .Rmd will be unaffected). If
you use RStudio, you can open this Rmd and click <strong>knit</strong>
to compile your workflow into a sharable html document.</p>
<p>Note that you can change anything you like in this code to build upon
your workflow. We envision that future versions of Wallace will enable
you to upload such modified .Rmds to Wallace to fill in all the options
you chose and pick up where you left off in a previous analysis in the
GUI.<br></p>
<p>You can also download the Metadata from Analysis. This will download
as a zip and contain a CSV file (.csv) for each species.</p>
<p><img src="vignette_img/reprod_2a.png" width="800px" style="display: block; margin: auto;"></p>
<p><img src="vignette_img/reprod_2b.png" width="800px" style="display: block; margin: auto;"></p>
<p>The last module available in the <strong>Reproduce</strong> component
is <em>Reference packages</em>. Here, you can download the citations for
all the R-packages used in the analysis.</p>
<p><img src="vignette_img/reprod_3a.png" width="800px" style="display: block; margin: auto;"></p>
<p><img src="vignette_img/reprod_3b.png" width="800px" style="display: block; margin: auto;"></p>
</div>
<div class="section level2">
<h2 id="conclusion">
<a id="Con"></a>Conclusion<a class="anchor" aria-label="anchor" href="#conclusion"></a>
</h2>
<p>With the improvement of multispecies analysis, <em>Wallace v2</em>
includes post-processing capabilities such as stacking models to get
estimates of species richness, and comparing models to estimate niche
overlap. We are currently working with partners, so stay tuned for
future versions of <em>Wallace</em>. Until then, you can always work in
<code>R</code> after the session by modifying the .Rmd and build on the
analysis.</p>
<p>Thank you for following the <em>Wallace v2</em> vignette. We hope you
learned more about the updated application, its features, and modeling
of species distributions and niches in general. We hate to be
repetitive, but we highly encourage you to read the guidance text,
follow up on the recommended publications, and hopefully let those lead
you to other relevant publications that can inform you further.<br></p>
<p>We encourage you to join the Wallace Google Group- We’d love to hear
your thoughts, opinions, or suggestions on how to make <em>Wallace</em>
better for all users. Members can post to the community and be updated
on any future announcements.</p>
</div>
<div class="section level2">
<h2 id="acknowledgments">
<a id="Ack"></a>Acknowledgments<a class="anchor" aria-label="anchor" href="#acknowledgments"></a>
</h2>
<p><em>Wallace</em> was recognized as a finalist for the 2015 Ebbe
Nielsen Challenge of the Global Biodiversity Information Facility
(GBIF), and received prize funding.<br>
This material is based upon work supported by the National Science
Foundation under Grant Numbers DBI-1661510 (RPA), DBI-1650241 (RPA),
DEB-1119915 (RPA), DEB-1046328 (MEA), DBI-1401312 (RM), and funding from
National Aeronautics and Space Administration grant 80NSSC18K0406 (MEB).
Any opinions, findings, and conclusions or recommendations expressed in
this material are those of the author(s) and do not necessarily reflect
the views of the NSF or NASA.</p>
</div>
<div class="section level2">
<h2 id="resources">
<a id="Res"></a>Resources<a class="anchor" aria-label="anchor" href="#resources"></a>
</h2>
<p>Wallace website <a href="https://wallaceecomod.github.io/" class="external-link uri">https://wallaceecomod.github.io/</a></p>
<p>ENM2020 W19T2 Online open access Ecological Niche Modeling Course by
A.T. Peterson, summary of modeling, includes Walkthrough of Wallace V1
<a href="https://www.youtube.com/watch?v=kWNyNd2X1uo&amp;t=1226s" class="external-link uri">https://www.youtube.com/watch?v=kWNyNd2X1uo&amp;t=1226s</a></p>
<p>Learn more about Olingos and the Olinguito <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC3760134/" class="external-link uri">https://www.ncbi.nlm.nih.gov/pmc/articles/PMC3760134/</a></p>
<p>Gerstner et al. (2018). <em>Revised distributional estimates for the
recently discovered olinguito (Bassaricyon neblina), with comments on
natural and taxonomic history.</em> <a href="https://doi.org/10.1093/jmammal/gyy012" class="external-link uri">https://doi.org/10.1093/jmammal/gyy012</a></p>
</div>
<div class="section level2">
<h2 id="references">
<a id="Ref"></a>References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<p>Phillips, S.J., Anderson, R.P., Dudík, M., Schapire, R.E., Blair,
M.E. (2017). Opening the black box: an open-source release of Maxent.
<em>Ecography</em>, 40(7), 887-893.
<a href="https://doi.org/10.1111/ecog.03049" target="_blank" class="external-link">https://doi.org/10.1111/ecog.03049</a></p>
<p>Helgen et al Helgen, K., Kays, R., Pinto, C., Schipper, J. &amp;
González-Maya, J.F. (2020). <em>Bassaricyon neblina</em> (amended
version of 2016 assessment). The IUCN Red List of Threatened Species
2020: e.T48637280A166523067.
<a href="https://www.iucnredlist.org/species/48637280/166523067" target="_blank" class="external-link">https://www.iucnredlist.org/species/48637280/166523067</a></p>
<p><a href="https://www.iucnredlist.org/species/48637566/45215534" class="external-link uri">https://www.iucnredlist.org/species/48637566/45215534</a>
Helgen, K., Kays, R., Pinto, C. &amp; Schipper, J. (2016).
<em>Bassaricyon alleni</em>. The IUCN Red List of Threatened Species
2016: e.T48637566A45215534.
<a href="https://www.iucnredlist.org/species/48637566/45215534" target="_blank" class="external-link">https://www.iucnredlist.org/species/48637566/45215534</a></p>
<p>Hijmans, R.J., Cameron, S.E., Parra, J.L., Jones, P.G., Jarvis, A.
(2005). Very high resolution interpolated climate surfaces for global
land areas. <em>International Journal of Climatology</em>, 25(15),
1965-1978.
<a href="https://doi.org/10.1002/joc.1276" target="_blank" class="external-link">https://doi.org/10.1002/joc.1276</a></p>
<p>Lima-Ribeiro, M.S., Varela, S., González-Hernández, J., Oliveira, G.,
Diniz-Filho, J.A.F., Terribile, L.C. (2015). ecoClimate: a database of
climate data from multiple models for past, present, and future for
Macroecologists and Biogeographers. <em>Biodiversity Informatics</em>
10, 1-21.
<a href="https://www.ecoclimate.org/" target="_blank" class="external-link">https://www.ecoclimate.org/</a></p>
<p>GBIF.org (2022). GBIF Home Page. Available from: <a href="https://www.gbif.org" class="external-link uri">https://www.gbif.org</a> [19
April 2022].</p>
<p>Aiello-Lammens M.E., Boria R.A., Radosavljevic A., Vilela B.,
Anderson R.P. (2015). spThin: an R package for spatial thinning of
species occurrence records for use in ecological niche models.
<em>Ecography</em>, 38(5), 541-545.
<a href="https://doi.org/10.1111/ecog.01132" target="_blank" class="external-link">https://doi.org/10.1111/ecog.01132</a></p>
<p>Gerstner, B.E., Kass, J.M., Kays, R., Helgen, K.M., Anderson, R.P.
(2018). Revised distributional estimates for the recently discovered
olinguito (<em>Bassaricyon neblina</em>), with comments on natural and
taxonomic history. <em>Journal of Mammalogy</em>, 99(2,3), 321-332.
<a href="https://doi.org/10.1093/jmammal/gyy012" target="_blank" class="external-link">https://doi.org/10.1093/jmammal/gyy012</a></p>
<p>Kass, J., Muscarella, R., Galante, P.J., Bohl, C.L.,
Pinilla-Buitrago, G.E., Boria, R.A., Soley-Guardia, M., Anderson, R.P.
(2021). ENMeval 2.0: Redesigned for customizable and reproducible
modeling of species’ niches and distributions. <em>Methods in Ecology
and Evolution</em>, 12(9), 1602-1608.
<a href="https://doi.org/10.1111/2041-210X.13628" target="_blank" class="external-link">https://doi.org/10.1111/2041-210X.13628</a></p>
<p>Merow, C., Smith, M.J., Silander, J.A. (2013). A practical guide to
MaxEnt for modeling species’ distributions: What it does, and why inputs
and settings matter. <em>Ecography</em>, 36(10), 1058-1069.
<a href="https://doi.org/10.1111/j.1600-0587.2013.07872.x" target="_blank" class="external-link">https://doi.org/10.1111/j.1600-0587.2013.07872.x</a></p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Jamie M. Kass, Gonzalo E. Pinilla-Buitrago, Andrea Paz,
Bruno Vilela, Matthew E. Aiello-Lammens, Robert Muscarella, Cory Merow,
Robert P. Anderson, Dean Attali.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a>
2.0.2.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
